
{% extends "base.html" %}
{% load static %}

{% block title %}게시글 작성{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'postform.css' %}">
{% endblock %}

{% block content %}

       <form class="post-form" action="/api/posts/create" method="post" enctype="multipart/form-data">
        
        <div class="form-header">
        <a href="javascript:history.back()" class="back-button" aria-label="이전 페이지로 이동">
            <!-- 뒤로가기 아이콘 -->
        <svg width="35" height="35" viewBox="0 0 35 35" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M16.6249 17.5L23.3333 24.2083L21.2916 26.25L12.5416 17.5L21.2916 8.75L23.3333 10.7917L16.6249 17.5Z" fill="black" fill-opacity="0.28"/>
        </svg>
        </a>
        <span class="form-title" id="form-title"></span> <!-----페이지에서 ?category=___ 값을 읽어 표시하는 방식---------->
        <!--완료 버튼-->
        <button type="submit" class="submit-button">완료</button>
        </div>
        <input type="text" name="title"  placeholder="제목을 입력해주세요">
        <textarea name="detail" placeholder="본문을 작성해주세요!"></textarea>
        <div class="file-upload">
            <label for="file">파일 삽입</label>
            <input type="file" id="file" name="file">
        </div>
        <div class="anonymous-check">
            <input type="checkbox" id="anonymous" name="anonymous">
            <label for="anonymous">익명</label>
        </div>
        </form>

    </main>
    <script>
    const textarea = document.getElementById("detail");
    textarea.addEventListener("input", function() {
    this.style.height = "auto";              // 높이를 초기화
    this.style.height = this.scrollHeight + "px"; // 내용에 맞게 다시 설정
     });


/******************목록 새로고침***********/
     const res = await fetch("/api/posts/create", {
    method: "POST",
    body: formData
});
if (res.ok) {
    loadBoardList(); // 저장 성공 후 목록 다시 불러오기
}

    </script>

<!--/*************URL 파라미터로 전달****************/-->
    
    <script>
  // URL에서 category 파라미터 읽기
  const params = new URLSearchParams(window.location.search);
  const category = params.get("category") || "게시판"; // 기본값

  // span에 적용
  document.getElementById("form-title").textContent = category + " 게시판";
</script>
{% endblock %}
